<!-- SADECE SCRIPT KISMI GÃœNCELLENDÄ° -->
<script>
const LS = localStorage;
const log = m => document.getElementById("logBox").innerText = m;

/* PROFÄ°L */
function loadProfile(){
  const p=JSON.parse(LS.getItem("profile")||"null");
  if(!p) return;
  let html=`<button class="contactBtn" onclick="acil(1)">Acil 1: ${p.a1ad}</button>`;
  if(p.a2ad) html+=`<button class="contactBtn" onclick="acil(2)">Acil 2: ${p.a2ad}</button>`;
  document.getElementById("contacts").innerHTML=html;
}

/* ACÄ°L â€“ SADECE 112 */
panicBtn.onclick=()=>location.href="tel:112";

/* ACÄ°L KÄ°ÅžÄ° */
window.acil=n=>{
  const p=JSON.parse(LS.getItem("profile"));
  const tel=n===1?p.a1tel:p.a2tel;

  /* 1ï¸âƒ£ Direkt arama */
  location.href="tel:"+tel;

  /* 2ï¸âƒ£ Konum al ve hazÄ±rla */
  navigator.geolocation?.getCurrentPosition(pos=>{
    const link=`https://maps.google.com/?q=${pos.coords.latitude},${pos.coords.longitude}`;
    const msg=`ðŸš¨ ACÄ°L | ${p.ad}\nKonum: ${link}`;

    /* 3ï¸âƒ£ SMS taslaÄŸÄ± */
    location.href="sms:"+tel+"?body="+encodeURIComponent(msg);

    /* 4ï¸âƒ£ WhatsApp / Share */
    navigator.share?.({title:"Acil",text:msg});

    log("Acil kiÅŸi bilgilendirildi");
  });
};

/* BÄ°LDÄ°RÄ°M */
permNotif.onclick=async()=>{
  if(Notification.permission==="denied"){
    permResult.innerText="Bildirim reddedilmiÅŸ. TarayÄ±cÄ± ayarlarÄ±ndan aÃ§.";
    return;
  }
  const r=await Notification.requestPermission();
  permResult.innerText="Bildirim: "+r;
};

/* INIT */
loadProfile();
</script>
